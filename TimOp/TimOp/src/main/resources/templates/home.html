<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>TimOp</title>
    <style>
        .preview-block {
          pointer-events: none;  /* í´ë¦­ ë°©ì§€ */
          z-index: 5;
        }
        #memberInfo {
          position: relative;
          left: 50px;
          display: inline-block;           /* ë‚´ìš© í¬ê¸°ë§Œí¼ë§Œ ê°ì‹¸ë„ë¡ */
          background-color: #4a90e2;       /* ë©”ì¸ í…Œë§ˆ ì»¬ëŸ¬ */
          color: #fff;                     /* ê¸€ììƒ‰ í°ìƒ‰ */
          padding: 0.6rem 1rem;            /* ìœ„ì•„ë˜Â·ì¢Œìš° ì—¬ë°± */
          border-radius: 6px;              /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
          font-weight: 500;                /* ì•½ê°„ êµµê²Œ */
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
          font-size: 1rem;
          margin: 1rem 0;                  /* ìœ„ì•„ë˜ ê°„ê²© */
        }

        #title {
            text-align: center;
            margin: 0;
            font-size: 2.5rem;
            font-weight: bold;
            /* í…ìŠ¤íŠ¸ ê·¸ë¼ë°ì´ì…˜ */
            background: linear-gradient(90deg, #ff8c00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            /* í…ìŠ¤íŠ¸ ê·¸ë¦¼ì */
            text-shadow: 2px 4px 8px rgba(0, 0, 0, 0.2);
          }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 5px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        td {
            background-color: #e7e7e7;
        }
        th:first-child, td:first-child {
            min-width: 50px; /* âœ… ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
            width: 20%; /* âœ… ì „ì²´ í…Œì´ë¸” ëŒ€ë¹„ ë¹„ìœ¨ ì„¤ì • */
            max-width: 80px; /* âœ… ë„ˆë¬´ ì»¤ì§€ì§€ ì•Šë„ë¡ ì œí•œ */
        }
        .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section {
            flex: 1;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin: 10px;
        }
        .form-group {
            margin-bottom: 20px;
        }

        label {
            margin-right: 10px;
        }

        input[type="text"], select {
            padding: 8px;
            margin-top: 5px;
        }

        input[type="checkbox"], input[type="radio"] {
            margin-right: 5px;
        }

        button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }
        .scrollable-list {
            height: 600px;
            overflow-y: auto;
            border: 2px solid #ccc;
            padding: 10px;
        }

        .tab-container {
            display: flex;
            border-bottom: 1px solid #ccc;
            margin-bottom: 20px;
        }

        .tab, .stab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
            background-color: #f9f9f9;
        }
        .tab.active, .stab.active {
            background-color: #fff;
            font-weight: bold;
            border-top: 2px solid #007BFF;
            border-right: 2px solid #007BFF;
            border-left: 2px solid #007BFF;
        }
        .tab-content, .stab-content {
            display: none;
        }
        .tab-content.active, .stab-content.active {
            width: 100%;
            height: 700px;
            border: 1px solid #ddd;
            display: block;
        }

        /* ì‹œê°„í‘œ ì „ì²´ ìŠ¤íƒ€ì¼ */
        .timetable-container {
            position: relative;
            width: 100%;
            height: 700px;
            border: 1px solid #ddd;
            overflow: hidden;
        }

        /* ê°•ì˜ ë¸”ë¡ ì»¨í…Œì´ë„ˆ */
        .lecture-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }


    /* ê°•ì˜ ë¸”ë¡ */
    .lecture-block {
        position: absolute;
        width: calc(100% - 10px); /* âœ… ìš”ì¼ë³„ í¬ê¸° ë§ì¶¤ */
        min-height: 20px; /* âœ… ìµœì†Œ ë†’ì´ ì„¤ì • */
        border-radius: 5px;
        background-color: white; /* âœ… ë°°ê²½ìƒ‰ */
        color: black; /* âœ… í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ ê²€ì€ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
        text-align: center;
        font-weight: bold;
        font-size: 12px; /* âœ… í°íŠ¸ í¬ê¸° ì¶•ì†Œ */
        line-height: 1.2; /* âœ… ì¤„ ê°„ê²© ì¡°ì • */
        padding: 2px 5px; /* âœ… íŒ¨ë”© ìµœì†Œí™” */
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);

        /* âœ… í…ìŠ¤íŠ¸ë¥¼ ì •ì¤‘ì•™ ë°°ì¹˜ */
        display: flex;
        align-items: center;
        justify-content: center;

        overflow: hidden; /* âœ… ë‚´ìš©ì´ ë„˜ì¹˜ë©´ ìë¥´ê¸° */
        text-overflow: ellipsis; /* âœ… ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ '...' í‘œì‹œ */
        word-wrap: break-word; /* âœ… ê¸´ ë‹¨ì–´ ìë™ ì¤„ë°”ê¿ˆ */
    }

    #timeGrid th, #timeGrid td {
        border: 1px solid #999;
        width: 80px;
        height: 40px;
        text-align: center;
        cursor: pointer;
    }
    #timeGrid td.selected {
        background-color: #4CAF50;
        color: white;
        font-weight: bold;
    }
    .range-block {
        margin: 5px 0;
        padding: 8px;
        background: #f1f1f1;
        border-left: 5px solid #4CAF50;
    }
    </style>
</head>
<body>
<header>
    <h1 id="title">TimOp</h1>
</header>
<div id="memberInfo"></div>
<button id="logoutButton" style="position:relative; left: 50px;">ë¡œê·¸ì•„ì›ƒ</button>
<div class="container">
    <section class="section" id="section1">
        <div class="tab-container">
            <div class="tab active" data-tab="tab1-1">ê²€ìƒ‰ ê²°ê³¼</div>
            <div class="tab" data-tab="tab1-2">ì‹œê°„í‘œ</div>
            <div class="tab" data-tab="tab1-3">ì¥ë°”êµ¬ë‹ˆ</div>
        </div>
        <div class="tab-content active" id="tab1-1">

        </div>
        <div class="tab-content" id="tab1-2">
            <p>ì‹œê°„í‘œ ë‚´ìš©</p>
        </div>
        <div class="tab-content" id="tab1-3">
            <p>íƒ­ 3 ë‚´ìš©</p>
        </div>
    </section>

    <section class="section" id="section2">
        <div>

            <form id="addTimetableForm" style="display: inline-block">
                <input type="text" name="name" placeholder="ìƒˆ ì‹œê°„í‘œ ì´ë¦„ ì…ë ¥" required style="display: inline-block; margin-right: 3px;"/>
                <button type="submit" >ì‹œê°„í‘œ ì¶”ê°€</button>
            </form>
            <button onclick="deleteActiveTimetable()" style="display: inline;">ì‹œê°„í‘œ ì‚­ì œ</button>
        </div>

        <div class="tab-container" id="stab-container">

        </div>

        <div id="timetable-container">

        </div>


    </section>
    <section class="section">
        <form id="titleSearchForm">
            <div class="form-group" style="position: relative; display: inline-block;">
                <label for="title">ê°•ì˜ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰:</label>
                <input type="text" id="searchBox" name="title">
                <ul id="suggestions" style="
                position: absolute;
                top: 100%; /* input ì•„ë˜ì— ë°”ë¡œ ë¶™ê²Œ */
                left: 45%;
                width:55%;
                background: white;
                border: 1px solid #ccc;
                list-style: none;
                padding: 0;
                margin: 0;
                display: none;
                z-index: 10;
              "></ul>
            </div>
            <div class="form-group"  style="display:inline;" >
                <button type="submit">ê²€ìƒ‰</button>
            </div>
        </form>
        <hr><br>

        <form id="searchForm">
            <div class="form-group">
                <label for="categoryDropdown">í•™ë¶€/ì „ê³µ:</label>
                <select id="categoryDropdown" name="major">
                    <option value=''>----</option>
                    <option value="ICTìœµí•©ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)">	ICTìœµí•©ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)</option>
                    <option value="Wel-Techìœµí•©ì „ê³µ (ë³µì§€ìœµí•©ëŒ€í•™)">	Wel-Techìœµí•©ì „ê³µ (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ê°€ìƒí˜„ì‹¤ì „ê³µ (ICTìœµí•©ê³µí•™ë¶€)">	ê°€ìƒí˜„ì‹¤ì „ê³µ (ICTìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ê±´ì¶•ê³µí•™ì „ê³µ (ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)">	ê±´ì¶•ê³µí•™ì „ê³µ (ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)</option>
                    <option value="ê²½ì˜í•™ì „ê³µ (ê¸€ë¡œë²Œê²½ì˜í•™ë¶€)">	ê²½ì˜í•™ì „ê³µ (ê¸€ë¡œë²Œê²½ì˜í•™ë¶€)</option>
                    <option value="ê²½ì˜í•™ì „ê³µ(ì•¼) (ê¸€ë¡œë²Œê²½ì˜í•™ë¶€(ì•¼))">	ê²½ì˜í•™ì „ê³µ(ì•¼) (ê¸€ë¡œë²Œê²½ì˜í•™ë¶€(ì•¼))</option>
                    <option value="ê²½ì œê¸ˆìœµì „ê³µ (ì •ê²½í•™ë¶€)">	ê²½ì œê¸ˆìœµì „ê³µ (ì •ê²½í•™ë¶€)</option>
                    <option value="ê²½ì œê¸ˆìœµì „ê³µ(ì•¼) (ì •ê²½í•™ë¶€(ì•¼))">	ê²½ì œê¸ˆìœµì „ê³µ(ì•¼) (ì •ê²½í•™ë¶€(ì•¼))</option>
                    <option value="ê³µê³µì¸ì¬í•™ì „ê³µ (ì •ê²½í•™ë¶€)">	ê³µê³µì¸ì¬í•™ì „ê³µ (ì •ê²½í•™ë¶€)</option>
                    <option value="ê³µê³µì¸ì¬í•™ì „ê³µ(ì•¼) (ì •ê²½í•™ë¶€(ì•¼))">	ê³µê³µì¸ì¬í•™ì „ê³µ(ì•¼) (ì •ê²½í•™ë¶€(ì•¼))</option>
                    <option value="êµì–‘ (ëŒ€í•™)">	êµì–‘ (ëŒ€í•™)</option>
                    <option value="êµì–‘(ì•¼) (êµì–‘)">	êµì–‘(ì•¼) (êµì–‘)</option>
                    <option value="êµìœ¡í•™ê³¼ (ì‚¬ë²”ëŒ€í•™)">	êµìœ¡í•™ê³¼ (ì‚¬ë²”ëŒ€í•™)</option>
                    <option value="êµ­ì œì§€ì—­í•™ê³¼ ">	êµ­ì œì§€ì—­í•™ê³¼ </option>
                    <option value="êµ­ì œì§€ì—­í•™ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)">	êµ­ì œì§€ì—­í•™ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)</option>
                    <option value="êµ­ì œí†µìƒí•™ì „ê³µ (ê¸€ë¡œë²Œê²½ì˜í•™ë¶€)">	êµ­ì œí†µìƒí•™ì „ê³µ (ê¸€ë¡œë²Œê²½ì˜í•™ë¶€)</option>
                    <option value="ê¸€ë¡œë²Œê²½ì˜í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ê¸€ë¡œë²Œê²½ì˜í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ê¸€ë¡œë²Œê²½ì˜í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ê¸€ë¡œë²Œê²½ì˜í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ê¸€ë¡œë²Œë¬¸í™”ì½˜í…ì¸ ëŒ€í•™ (ëŒ€í•™)">	ê¸€ë¡œë²Œë¬¸í™”ì½˜í…ì¸ ëŒ€í•™ (ëŒ€í•™)</option>
                    <option value="ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€ (ê¸€ë¡œë²Œì¸ì¬ëŒ€í•™)">	ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€ (ê¸€ë¡œë²Œì¸ì¬ëŒ€í•™)</option>
                    <option value="ê¸°ë…êµì»¤ë®¤ë‹ˆì¼€ì´ì…˜í•™ê³¼ ">	ê¸°ë…êµì»¤ë®¤ë‹ˆì¼€ì´ì…˜í•™ê³¼ </option>
                    <option value="ê¸°ë…êµí•™ê³¼ (ê¸€ë¡œë²Œì¸ì¬ëŒ€í•™)">	ê¸°ë…êµí•™ê³¼ (ê¸€ë¡œë²Œì¸ì¬ëŒ€í•™)</option>
                    <option value="ê¸°ë…êµí•™ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)">	ê¸°ë…êµí•™ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)</option>
                    <option value="ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)">	ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ë„ì‹œê±´ì¶•ìœµí•©ê³µí•™ì „ê³µ (ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)">	ë„ì‹œê±´ì¶•ìœµí•©ê³µí•™ì „ê³µ (ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)</option>
                    <option value="ë””ìì¸í•™ê³¼ ">	ë””ìì¸í•™ê³¼ </option>
                    <option value="ë¬¸í™”ì½˜í…ì¸ ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)">	ë¬¸í™”ì½˜í…ì¸ ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)</option>
                    <option value="ë¬¸í™”ì½˜í…ì¸ í•™ê³¼ ">	ë¬¸í™”ì½˜í…ì¸ í•™ê³¼ </option>
                    <option value="ë°˜ë„ì²´ì‹œìŠ¤í…œìœµí•©ì „ê³µ ">	ë°˜ë„ì²´ì‹œìŠ¤í…œìœµí•©ì „ê³µ </option>
                    <option value="ë²•í–‰ì •ì„¸ë¬´í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ë²•í–‰ì •ì„¸ë¬´í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ë²•í–‰ì •ì„¸ë¬´í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ë²•í–‰ì •ì„¸ë¬´í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ë³µì§€ìœµí•©ëŒ€í•™ (ëŒ€í•™)">	ë³µì§€ìœµí•©ëŒ€í•™ (ëŒ€í•™)</option>
                    <option value="ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€ (ICTê±´ì„¤ê³µê³¼ëŒ€í•™)">	ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€ (ICTê±´ì„¤ê³µê³¼ëŒ€í•™)</option>
                    <option value="ë¶€ë™ì‚°í•™ì „ê³µ (ICTê±´ì„¤ê³µê³¼ëŒ€í•™>ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)">	ë¶€ë™ì‚°í•™ì „ê³µ (ICTê±´ì„¤ê³µê³¼ëŒ€í•™>ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)</option>
                    <option value="ì‚¬íšŒë³µì§€í•™ë¶€ (ë³µì§€ìœµí•©ëŒ€í•™)">	ì‚¬íšŒë³µì§€í•™ë¶€ (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ì‚¬íšŒë³µì§€í•™ë¶€(ì•¼) (ë³µì§€ìœµí•©ëŒ€í•™)">	ì‚¬íšŒë³µì§€í•™ë¶€(ì•¼) (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ì‚¬íšŒì‚¬ì—…í•™ì „ê³µ (ì‚¬íšŒë³µì§€í•™ë¶€)">	ì‚¬íšŒì‚¬ì—…í•™ì „ê³µ (ì‚¬íšŒë³µì§€í•™ë¶€)</option>
                    <option value="ì‚¬íšŒì‚¬ì—…í•™ì „ê³µ(ì•¼) (ì‚¬íšŒë³µì§€í•™ë¶€(ì•¼))">	ì‚¬íšŒì‚¬ì—…í•™ì „ê³µ(ì•¼) (ì‚¬íšŒë³µì§€í•™ë¶€(ì•¼))</option>
                    <option value="ì‚¬íšŒì„œë¹„ìŠ¤ì •ì±…í•™ì „ê³µ (ì‚¬íšŒë³µì§€í•™ë¶€)">	ì‚¬íšŒì„œë¹„ìŠ¤ì •ì±…í•™ì „ê³µ (ì‚¬íšŒë³µì§€í•™ë¶€)</option>
                    <option value="ì‚°ì—…ê²½ì˜ê³µí•™ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)">	ì‚°ì—…ê²½ì˜ê³µí•™ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ì‚°ì—…ê³µí•™ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)">	ì‚°ì—…ê³µí•™ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ìƒê²½í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ìƒê²½í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ìƒê²½í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ìƒê²½í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ì„¸ë¬´í•™ì „ê³µ (ì •ê²½í•™ë¶€)">	ì„¸ë¬´í•™ì „ê³µ (ì •ê²½í•™ë¶€)</option>
                    <option value="ì„¸ë¬´í•™ì „ê³µ(ì•¼) (ì •ê²½í•™ë¶€(ì•¼))">	ì„¸ë¬´í•™ì „ê³µ(ì•¼) (ì •ê²½í•™ë¶€(ì•¼))</option>
                    <option value="ì†Œí”„íŠ¸ì›¨ì–´ì „ê³µ (ICTìœµí•©ê³µí•™ë¶€)">	ì†Œí”„íŠ¸ì›¨ì–´ì „ê³µ (ICTìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ìŠ¤ë§ˆíŠ¸ë„ì‹œê³µí•™ì „ê³µ (ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)">	ìŠ¤ë§ˆíŠ¸ë„ì‹œê³µí•™ì „ê³µ (ë¶€ë™ì‚°ê±´ì„¤í•™ë¶€)</option>
                    <option value="ìŠ¤í¬ì¸ ë³µì§€ì „ê³µ (ì˜ˆì²´ëŠ¥í•™ë¶€)">	ìŠ¤í¬ì¸ ë³µì§€ì „ê³µ (ì˜ˆì²´ëŠ¥í•™ë¶€)</option>
                    <option value="ìŠ¤í¬ì¸ ë³µì§€í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)">	ìŠ¤í¬ì¸ ë³µì§€í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ì‹œë‹ˆì–´ë¹„ì¦ˆë‹ˆìŠ¤í•™ê³¼ ">	ì‹œë‹ˆì–´ë¹„ì¦ˆë‹ˆìŠ¤í•™ê³¼ </option>
                    <option value="ì‹¤ë²„ì‚°ì—…í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)">	ì‹¤ë²„ì‚°ì—…í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ìœ ë‹ˆë²„ì„¤ì•„íŠ¸ë””ìì¸ì „ê³µ (ì˜ˆì²´ëŠ¥í•™ë¶€)">	ìœ ë‹ˆë²„ì„¤ì•„íŠ¸ë””ìì¸ì „ê³µ (ì˜ˆì²´ëŠ¥í•™ë¶€)</option>
                    <option value="ìœ ë‹ˆë²„ì„¤ì•„íŠ¸ë””ìì¸í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)">	ìœ ë‹ˆë²„ì„¤ì•„íŠ¸ë””ìì¸í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ìœ ì•„êµìœ¡ê³¼ (ì‚¬ë²”ëŒ€í•™)">	ìœ ì•„êµìœ¡ê³¼ (ì‚¬ë²”ëŒ€í•™)</option>
                    <option value="ìŒì•…í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)">	ìŒì•…í•™ê³¼ (ë³µì§€ìœµí•©ëŒ€í•™)</option>
                    <option value="ìŒì•…í•™ì „ê³µ (ì˜ˆì²´ëŠ¥í•™ë¶€)">	ìŒì•…í•™ì „ê³µ (ì˜ˆì²´ëŠ¥í•™ë¶€)</option>
                    <option value="ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)">	ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)</option>
                    <option value="ì¸ê³µì§€ëŠ¥ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)">	ì¸ê³µì§€ëŠ¥ì „ê³µ (ì¸ê³µì§€ëŠ¥ìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ììœ ì „ê³µí•™ë¶€ (ë¶€ì´ì¥ì§ì†)">	ììœ ì „ê³µí•™ë¶€ (ë¶€ì´ì¥ì§ì†)</option>
                    <option value="ììœ ì „ê³µí•™ë¶€(ì•¼) (ë¶€ì´ì¥ì§ì†)">	ììœ ì „ê³µí•™ë¶€(ì•¼) (ë¶€ì´ì¥ì§ì†)</option>
                    <option value="ì „ìê³µí•™ì „ê³µ (ICTìœµí•©ê³µí•™ë¶€)">	ì „ìê³µí•™ì „ê³µ (ICTìœµí•©ê³µí•™ë¶€)</option>
                    <option value="ì „ìë°˜ë„ì²´ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)">	ì „ìë°˜ë„ì²´ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)</option>
                    <option value="ì •ê²½í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ì •ê²½í•™ë¶€ (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ì •ê²½í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)">	ì •ê²½í•™ë¶€(ì•¼) (ê²½ì˜ê´€ë¦¬ëŒ€í•™)</option>
                    <option value="ì¤‘êµ­ì§€ì—­í•™ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)">	ì¤‘êµ­ì§€ì—­í•™ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)</option>
                    <option value="ì¤‘êµ­ì½˜í…ì¸ ë¹„ì¦ˆë‹ˆìŠ¤í•™ê³¼ ">	ì¤‘êµ­ì½˜í…ì¸ ë¹„ì¦ˆë‹ˆìŠ¤í•™ê³¼ </option>
                    <option value="ì¤‘ë“±íŠ¹ìˆ˜êµìœ¡ê³¼ (ì‚¬ë²”ëŒ€í•™)">	ì¤‘ë“±íŠ¹ìˆ˜êµìœ¡ê³¼ (ì‚¬ë²”ëŒ€í•™)</option>
                    <option value="ì²´ìœ¡í•™ê³¼ ">	ì²´ìœ¡í•™ê³¼ </option>
                    <option value="ì´ˆë“±íŠ¹ìˆ˜êµìœ¡ê³¼ (ì‚¬ë²”ëŒ€í•™)">	ì´ˆë“±íŠ¹ìˆ˜êµìœ¡ê³¼ (ì‚¬ë²”ëŒ€í•™)</option>
                    <option value="ì»´í“¨í„°ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)">	ì»´í“¨í„°ê³µí•™ë¶€ (ê³µê³¼ëŒ€í•™)</option>
                    <option value="í•œì˜ë¬¸í™”ì½˜í…ì¸ ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)">	í•œì˜ë¬¸í™”ì½˜í…ì¸ ì „ê³µ (ê¸€ë¡œë²Œë¬¸í™”í•™ë¶€)</option>
                </select>
            </div>
            <div class="form-group">
                <fieldset>
                    <legend>í•™ë…„</legend>
                    <label><input type="checkbox" class="otherCheckboxes" name="grade" value="0"> 0í•™ë…„</label>
                    <label><input type="checkbox" class="otherCheckboxes" name="grade" value="1"> 1í•™ë…„</label>
                    <label><input type="checkbox" class="otherCheckboxes" name="grade" value="2"> 2í•™ë…„</label>
                    <label><input type="checkbox" class="otherCheckboxes" name="grade" value="3"> 3í•™ë…„</label>
                    <label><input type="checkbox" class="otherCheckboxes" name="grade" value="4"> 4í•™ë…„</label>
                </fieldset>
            </div>
            <div class="form-group">
                <fieldset>
                    <legend>í•™ì </legend>
                    <label><input type="checkbox" name="credit" value="0"> 0í•™ì </label>
                    <label><input type="checkbox" name="credit" value="1"> 1í•™ì </label>
                    <label><input type="checkbox" name="credit" value="2"> 2í•™ì </label>
                    <label><input type="checkbox" name="credit" value="3"> 3í•™ì </label>
                </fieldset>
            </div>
            <div class="form-group">
                <fieldset>
                    <legend>ê· í˜•/ìì„ </legend>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="1ì˜ì—­"> 1ì˜ì—­</label>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="2ì˜ì—­"> 2ì˜ì—­</label>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="3ì˜ì—­"> 3ì˜ì—­</label>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="4ì˜ì—­"> 4ì˜ì—­</label>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="5ì˜ì—­"> 5ì˜ì—­</label>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="ìì„ "> ìì„ </label>
                    <label><input type="checkbox" class="liberalArtsCheckboxes" name="liberalArts" value="ì¼ë°˜"> ì¼ë°˜</label>
                </fieldset>
            </div>
            <div class="form-group">
                <fieldset>
                    <legend>ì‹œê°„ëŒ€ ê²€ìƒ‰</legend>
                    <label>
                        <input type="checkbox" id="timeSearchCheckbox"> ì‹œê°„ëŒ€ ê²€ìƒ‰
                    </label>
                    <br>
                    <label>
                        <input type="radio" name="availability" value="empty" id="emptyTime" disabled>
                        ë¹ˆ ì‹œê°„ëŒ€ ê²€ìƒ‰
                    </label>
                    <label>
                        <input type="radio" name="availability" value="custom" id="customTime" disabled>
                        ì‹œê°„ëŒ€ ì§ì ‘ ì„ íƒí•˜ê¸°
                    </label>
                    <button type="button" id="openTimePicker" disabled>ì„ íƒì°½ ì—´ê¸°</button>
                </fieldset>
            </div>
            <div>
                <button type="submit">ê²€ìƒ‰</button>
            </div>
        </form>
    </section>
</div>

<div id="timePickerModal" style="display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%);
    background:white; border:1px solid #ccc; padding:20px; z-index:1000; box-shadow:0 0 10px #999;">
    <h3>ì‹œê°„ëŒ€ ì„ íƒ (ë“œë˜ê·¸ë¡œ ë¸”ë¡ ìƒì„±)</h3>
    <div id="gridWrapper" style="overflow-x:auto;">
        <table id="timeGrid" style="border-collapse:collapse;">
            <thead>
            <tr>
                <th>ì‹œê°„ / ìš”ì¼</th>
                <th>ì›”</th><th>í™”</th><th>ìˆ˜</th><th>ëª©</th><th>ê¸ˆ</th>
            </tr>
            </thead>
            <tbody>
            <!-- JavaScriptë¡œ 9ì‹œ~22ì‹œ í–‰ ìƒì„± -->
            </tbody>
        </table>
    </div>

    <div id="rangeList"></div>

    <button onclick="applyBlocks()">í™•ì¸</button>
    <button onclick="closeTimePicker()">ë‹«ê¸°</button>
</div>

<script>
    document.getElementById('searchForm').addEventListener('submit', async function(event) {
        const activeTab = document.querySelector('.stab.active');
        if (activeTab) {
            const timetableName = activeTab.textContent.trim();

            const form = document.getElementById("searchForm");

            // ê¸°ì¡´ timetableName inputì´ ìˆìœ¼ë©´ ì œê±° (ì¤‘ë³µ ë°©ì§€)
            const existingInput = form.querySelector("input[name='timetableName']");
            if (existingInput) {
                existingInput.remove();
            }

            // ìƒˆë¡œìš´ hidden input ìƒì„±
            const hidden = document.createElement("input");
            hidden.type = "hidden";
            hidden.name = "timetableName";
            hidden.value = timetableName;

            // formì— ì¶”ê°€
            form.appendChild(hidden);
        }

        const checkbox = document.getElementById("timeSearchCheckbox");
        const availabilityRadios = document.querySelectorAll('input[name="availability"]');

        const isTimeSearchChecked = checkbox.checked;
        const selectedAvailability = [...availabilityRadios].find(r => r.checked)?.value;
        const isCustomMode = (selectedAvailability === "custom");

        if (!isTimeSearchChecked || !isCustomMode) {
            this.querySelectorAll("input[name='days'], input[name='startTimes'], input[name='endTimes']")
                .forEach(e => e.remove());
        }

        event.preventDefault(); // ê¸°ë³¸ í¼ ì œì¶œ ë°©ì§€

        const form = event.target;
        const formData = new FormData(form);
        const params = new URLSearchParams();

        // ë¹ˆ ê°’ ì œê±°
        for (const [key, value] of formData.entries()) {
            if (value.trim() !== '') {
                params.append(key, value);
            }
        }

        const url = `/search/condition?${params.toString()}`;
        console.log("url", url);
        try {
            const response = await fetch(url, {
                method: 'GET',
                headers: { "Content-Type": "application/json",
                'Cache-Control': 'no-store',
                "Authorization": "Bearer " + localStorage.getItem("accessToken")}
            });

            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const data = await response.json();
            renderSearchLectures(data); // ê²€ìƒ‰ ê²°ê³¼ ë Œë”ë§
        } catch (error) {
            console.error('ê²€ìƒ‰ ì˜¤ë¥˜:', error);
        }
    });


    document.querySelectorAll('.liberalArtsCheckboxes').forEach(function(checkbox) {
        checkbox.addEventListener('change', function() {
            if (this.checked) {
                // Reset dropdown menu
                document.getElementById('categoryDropdown').selectedIndex = 0;

                // Uncheck other checkboxes
                document.querySelectorAll('.otherCheckboxes').forEach(function(otherCheckbox) {
                    otherCheckbox.checked = false;
                });
            }
        });
    });

    // Dropdown menu change event
    document.getElementById('categoryDropdown').addEventListener('change', function() {
        // Uncheck all liberal arts checkboxes
        document.querySelectorAll('.liberalArtsCheckboxes').forEach(function(checkbox) {
            checkbox.checked = false;
        });
    });

    // Other checkboxes change event
    document.querySelectorAll('.otherCheckboxes').forEach(function(checkbox) {
        checkbox.addEventListener('change', function() {
            if (this.checked) {
                // Uncheck all liberal arts checkboxes
                document.querySelectorAll('.liberalArtsCheckboxes').forEach(function(libCheckbox) {
                    libCheckbox.checked = false;
                });
            }
        });
    });

    function setupTabEvents(sectionId) {
        const section = document.getElementById(sectionId);
        if (!section) return; // ì„¹ì…˜ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸

        const tabs = section.querySelectorAll('.tab, .stab');
        const contents = section.querySelectorAll('.tab-content, .stab-content');

        tabs.forEach(function(tab) {
            tab.addEventListener('click', function() {
                // ëª¨ë“  íƒ­ê³¼ ì½˜í…ì¸ ë¥¼ ë¹„í™œì„±í™”
                tabs.forEach(function(t) { t.classList.remove('active'); });
                contents.forEach(function(c) { c.classList.remove('active'); });

                // í´ë¦­ëœ íƒ­ê³¼ ì—°ê²°ëœ ì½˜í…ì¸ ë¥¼ í™œì„±í™”
                tab.classList.add('active');

                const content = section.querySelector(`#${tab.dataset.tab}`);
                if (content) {
                    content.classList.add('active');
                }
            });
        });
    }
    function getActiveTimetableName() {
    console.log("getActiveTimetableName ì‹¤í–‰ë¨");

    const forms = document.querySelectorAll(".lectureForm"); // ëª¨ë“  lectureForm ì°¾ê¸°

    forms.forEach(form => {
        const timetableNameInput = form.querySelector(".timetableName"); // í•´ë‹¹ í¼ ë‚´ë¶€ì˜ input ì°¾ê¸°
        if (!timetableNameInput){
            return;
        }


        form.addEventListener("submit", function (event) {
            const activeTab = document.querySelector(".stab.active"); // í™œì„±í™”ëœ ì‹œê°„í‘œ ì°¾ê¸°

            if (activeTab) {
                console.log("Active Tab Found:", activeTab.textContent.trim());
                timetableNameInput.value = activeTab.textContent.trim();
            } else {
                console.warn("No active tab found.");
                timetableNameInput.value = "";
            }
        });
    });
}


    document.addEventListener('DOMContentLoaded', function() {
        setupTabEvents('section1');
        setupTabEvents('section2');
        getActiveTimetableName();
        fetchUserProfile();
        renderCart();
        fetchTimetables();
    });


    //ì‹œê°„í‘œ íƒ­ì—ì„œ í™œì„±í™”ëœ ì‹œê°„í‘œ ì´ë¦„ ê°€ì ¸ì˜¨ í›„ DELETE ë¹„ë™ê¸° ìš”ì²­ ë³´ë‚´ê³  íƒ­ ì‚­ì œ í›„ ì²« íƒ­ìœ¼ë¡œ
    function deleteActiveTimetable() {
        const activeTab = document.querySelector('.stab.active');
        if (!activeTab) {
            alert("ì‚­ì œí•  ì‹œê°„í‘œë¥¼ ì„ íƒí•˜ì„¸ìš”.");
            return;
        }
        const activeTabContent = document.querySelector('.stab-content.active');

        // ì‹œê°„í‘œ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
        const timetableName = activeTab.textContent.trim();
        const token = localStorage.getItem("accessToken");
        // ì„œë²„ë¡œ DELETE ìš”ì²­ ë³´ë‚´ê¸°
        fetch('/timetables/' + encodeURIComponent(timetableName), {
            method: 'DELETE',
            headers: {
              "Content-Type": "application/json",
              "Authorization": "Bearer " + localStorage.getItem("accessToken"),
            }})
        .then(response => {
            if (response.ok) {
                alert("ì‹œê°„í‘œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");

                // ì‚­ì œëœ íƒ­ì„ UIì—ì„œ ì œê±°
                activeTab.remove();
                activeTabContent.remove();
                // ì²« ë²ˆì§¸ íƒ­ ìë™ í™œì„±í™”
                const firstTab = document.querySelector('.stab');
                if (firstTab) {
                    firstTab.classList.add('active');
                    const firstTabContent = document.getElementById(firstTab.dataset.tab);
                    if (firstTabContent) {
                        firstTabContent.classList.add('active');
                    }
                }
            } else {
                alert("ì‚­ì œ ì‹¤íŒ¨!");
            }
        })
        .catch(error => console.error('Error:', error));
    }
    //ì„¹ì…˜2 ì‹œê°„í‘œ íƒ­ê³¼ ì‹œê°„í‘œ ê°•ì˜ í‘œì‹œ
    function fetchTimetables() {
        fetch('/timetables', {method: "GET",
          headers: {
            "Authorization": "Bearer " + localStorage.getItem("accessToken"),
            'Cache-Control': 'no-store',
          }}).then(response => response.json())
            .then(data => {
                timetables = data;
                renderTabs(data);
                if (data.length > 0) {
                    renderLectures(data[0]); // ì²« ë²ˆì§¸ ì‹œê°„í‘œì˜ ê°•ì˜ ì •ë³´ í‘œì‹œ
                    getTimetableLectures();
                }
            })
            .catch(error => console.error("ì‹œê°„í‘œ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", error));
    }

    function renderTabs(timetables) {
    const tabContainer = document.getElementById("stab-container");
    const timetableContainer = document.getElementById("timetable-container");
    tabContainer.innerHTML = "";
    timetableContainer.innerHTML = "";

    timetables.forEach((timetable, index) => {

            // ğŸ”¹ íƒ­ ìƒì„±
            let tab = document.createElement("div");
            tab.className = "stab" + (index === 0 ? " active" : "");
            tab.dataset.tab = "stab" + (index + 1);
            tab.textContent = timetable.name;
            tab.onclick = () => {
                document.querySelectorAll(".stab").forEach(t => t.classList.remove("active"));
                document.querySelectorAll(".stab-content").forEach(c => c.classList.remove("active"));
                tab.classList.add("active");
                document.getElementById("stab" + (index + 1)).classList.add("active");
                const activeTab = document.querySelector('.stab.active');
                if (!activeTab) {
                    return;
                }
                const timetableName = activeTab.textContent.trim();

                fetch('/timetables/' + encodeURIComponent(timetableName),
                 {  method: "GET",
                    headers: {
                      "Content-Type": "application/json",
                      'Cache-Control': 'no-store',
                      "Authorization": "Bearer " + localStorage.getItem("accessToken"),
                    }})
                    .then(response => response.json())
                    .then(data => {
                        console.log("getTimetable:", data);
                        renderLectures(data);
                    })
                    .catch(error => console.error("ì‹œê°„í‘œ íƒ­ í´ë¦­ ì—ëŸ¬:", error));

                getTimetableLectures();
            };
            tabContainer.appendChild(tab);

            // ğŸ”¹ ì‹œê°„í‘œ ë° ê°•ì˜ ë¸”ë¡ ì»¨í…Œì´ë„ˆ ì¶”ê°€
            let tableContent = `
                <div class="stab-content ${index === 0 ? "active" : ""}" id="stab${index + 1}">
                    <div class="timetable-container">
                        <table class="timetable">
                            <thead>
                                <tr>
                                    <th>ì‹œê°„ / ìš”ì¼</th>
                                    <th>ì›”</th><th>í™”</th><th>ìˆ˜</th><th>ëª©</th><th>ê¸ˆ</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${Array.from({length: 14}, (_, i) => {
                                    let hour = i + 9;
                                    return `
                                        <tr data-hour="${hour}">
                                            <td>${hour}:00</td>
                                            <td></td><td></td><td></td><td></td><td></td>
                                        </tr>`;
                                }).join('')}
                            </tbody>
                        </table>
                        <div class="lecture-container"></div> <!-- ğŸ”¹ ê°•ì˜ ë¸”ë¡ ì»¨í…Œì´ë„ˆ -->
                    </div>
                </div>`;
            timetableContainer.innerHTML += tableContent;
        });
    }

function renderLectures(timetable) {
    const days = { "ì›”": 1, "í™”": 2, "ìˆ˜": 3, "ëª©": 4, "ê¸ˆ": 5 };
    const startHour = 9; // ì‹œê°„í‘œ ì‹œì‘ ì‹œê°„

    let activeTab = document.querySelector('.stab-content.active');
    if (!activeTab) return;

    let container = activeTab.querySelector(".lecture-container");
    if (!container) return;

    let table = activeTab.querySelector(".timetable");
    if (!table) return;

    let timetableHeaderCells = activeTab.querySelectorAll(".timetable thead th");

    let timetableBody = activeTab.querySelector(".timetable tbody");


    if (timetableHeaderCells.length < 6 || !timetableBody) return;

    // âœ… ìš”ì¼(ì›”~ê¸ˆ) ì˜ì—­ì˜ ë†’ì´ë¥¼ ê°€ì ¸ì˜¤ê¸°
    let theadHeight = activeTab.querySelector(".timetable thead").offsetHeight;
    // âœ… ìš”ì¼ ì¹¼ëŸ¼ í¬ê¸° ê³„ì‚° (2ì—´ë¶€í„° ì ìš©)
    let columnWidth = timetableHeaderCells[1].offsetWidth;


    // âœ… ë™ì ìœ¼ë¡œ ì‹œê°„ë‹¹ ë†’ì´ ê³„ì‚° (tbody ë†’ì´ Ã· ì‹œê°„ ê°œìˆ˜)
    let totalHours = timetableBody.querySelectorAll("tr").length; // ì´ ì‹œê°„ ê°œìˆ˜
    let timetableHeight = timetableBody.offsetHeight; // tbody ë†’ì´
    let hourHeight = timetableHeight / totalHours; // í•œ ì‹œê°„ë‹¹ ë†’ì´


    container.innerHTML = ""; // ê¸°ì¡´ ê°•ì˜ ë¸”ë¡ ì œê±° í›„ ë‹¤ì‹œ ê·¸ë¦¬ê¸°

    console.log("renderLectures timetable", timetable);

    timetable.lectures.forEach(lecture => {
        lecture.lectureTimes.forEach(lt => {
            let dayIndex = days[lt.dayOfWeek];
            if (dayIndex === undefined) return;
            console.log("ë¸”ë¡ ê°•ì˜:", lecture);
            let { hour: startHourValue, minute: startMinuteValue } = parseTime(lt.startTime);
            let { hour: endHourValue, minute: endMinuteValue } = parseTime(lt.endTime);

            // âœ… ì‹œì‘ ìœ„ì¹˜ ê³„ì‚° (thead ë†’ì´ ê³ ë ¤)
            let startOffset = theadHeight + ((startHourValue - startHour) * hourHeight) + (startMinuteValue / 60 * hourHeight);

            // âœ… ê°•ì˜ ê¸¸ì´ ê³„ì‚° (ë¹„ìœ¨ ì ìš©)
            let durationInMinutes = (endHourValue * 60 + endMinuteValue) - (startHourValue * 60 + startMinuteValue);
            let blockHeight = (durationInMinutes / 60) * hourHeight;

            // âœ… ê°•ì˜ ë¸”ë¡ ìƒì„±
            let lectureBlock = document.createElement("div");
            lectureBlock.id = "lb" + lecture.id;
            lectureBlock.classList.add("lecture-block");
            lectureBlock.style.top = `${startOffset}px`; // âœ… ìš”ì¼ ë¶€ë¶„ì„ ê°€ë¦¬ì§€ ì•Šë„ë¡ ë³´ì •
            lectureBlock.style.height = `${blockHeight}px`; // âœ… ë†’ì´ ìë™ ê³„ì‚°

            // "ì‹œê°„ / ìš”ì¼" ì¹¼ëŸ¼ì˜ ë„ˆë¹„ ê°€ì ¸ì˜¤ê¸°
            let timeColumnWidth = timetableHeaderCells[0].offsetWidth;
            lectureBlock.style.left = `${timeColumnWidth + (dayIndex - 1) * columnWidth}px`;

            lectureBlock.style.width = `${columnWidth - 10}px`; // âœ… ì¹¼ëŸ¼ í¬ê¸° ë§ì¶¤
            lectureBlock.style.backgroundColor = getLectureColor(lecture.title);
            lectureBlock.textContent = lecture.title;

            container.appendChild(lectureBlock);
        });
    });
}

function parseTime(timeString) {
    let [hour, minute] = timeString.split(":").map(Number); // "15:30:00" â†’ [15, 30]
    return { hour, minute };
}

let timetables = [];
let tabLectures = [];

window.addEventListener("resize", () => {
    let activeTab = document.querySelector(".stab-content.active");
    if (activeTab) {

        let timetableIndex = Array.from(document.querySelectorAll(".stab-content")).indexOf(activeTab) + 1;
        console.log(timetableIndex);
        let timetableData = timetables[timetableIndex - 1];
        renderLectures(timetableData);
    }
});


// ğŸ”¹ ê°•ì˜ë§ˆë‹¤ ê³ ìœ í•œ ìƒ‰ìƒ ì ìš©
const colors = ["#FFC0CB", "#FFD700", "#87CEFA", "#90EE90", "#FF6347", "#DA70D6", "#40E0D0", "#FFA07A"];
const lectureColors = {};

function getLectureColor(lectureTitle) {
    if (!lectureColors[lectureTitle]) {
        let index = Object.keys(lectureColors).length % colors.length;
        lectureColors[lectureTitle] = colors[index];
    }
    return lectureColors[lectureTitle];
}

//ì‹œê°„í‘œ ì´ë¦„ìœ¼ë¡œ DBì—ì„œ ì‹œê°„í‘œ ì¡°íšŒ í›„ ì‹œê°„í‘œì— í¬í•¨ëœ ê°•ì˜ ë¦¬ìŠ¤íŠ¸ ë°›ì•„ì„œ section1 ì‹œê°„í‘œ ë¶€ë¶„ì— ë¦¬ìŠ¤íŠ¸ ë¿Œë¦¬ê¸°

function getTimetableLectures() {
    const activeTab = document.querySelector('.stab.active');
    if (!activeTab) {
        return;
    }

    // ì‹œê°„í‘œ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
    const timetableName = activeTab.textContent.trim();

    // ì„œë²„ë¡œ GET ìš”ì²­ ë³´ë‚´ê¸°
    fetch('/timetables/' + encodeURIComponent(timetableName)+ '/lectures', {
        method: 'GET',
        headers: {
        'Cache-Control': 'no-store',
        "Authorization": "Bearer " + localStorage.getItem("accessToken")}
    })
    .then(response => response.json())
    .then(data => {
        console.log("ë¶ˆëŸ¬ì˜¨ ê°•ì˜ ë¦¬ìŠ¤íŠ¸:", data);

        // ì‹œê°„í‘œ ë‚´ìš©ì„ ì—…ë°ì´íŠ¸í•  ì»¨í…Œì´ë„ˆ ì°¾ê¸°
        const tabContent = document.getElementById('tab1-2');
        if (!tabContent) {
            console.error("ì‹œê°„í‘œ ì»¨í…ì¸  ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }

        // ê¸°ì¡´ ëª©ë¡ ì‚­ì œ
        tabContent.innerHTML = "";

        // ìƒˆë¡œìš´ ê°•ì˜ ëª©ë¡ ì¶”ê°€
        const ul = document.createElement("ul");
        ul.className = "scrollable-list";
        data.forEach(lecture => {
            const li = document.createElement("li");
            li.textContent = lecture.title;  // ê°•ì˜ ì´ë¦„ ì¶”ê°€

            const deleteButton = document.createElement("button");
            deleteButton.textContent = "ì‹œê°„í‘œì—ì„œ ì‚­ì œ";
            deleteButton.style.marginLeft = "10px";
            deleteButton.dataset.id = lecture.id; // ë°ì´í„° ID ì €ì¥

            deleteButton.addEventListener("click", function () {
                const activeTab = document.querySelector('.stab.active');
                if (!activeTab) {
                    return;
                }
                const timetableName = activeTab.textContent.trim();

                const lectureId = this.dataset.id;
                const apiUrl = `/timetables/${timetableName}/lectures/${lectureId}`;

                fetch(apiUrl, {
                    method: "DELETE",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": "Bearer " + localStorage.getItem("accessToken"),
                    },
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`ì‚­ì œ ì‹¤íŒ¨: ${response.status}`);
                    }
                    return response.json();
                })
                .then(() => {
                    alert(`${lecture.title} ì‚­ì œ ì™„ë£Œ!`);
                    li.remove(); // ëª©ë¡ì—ì„œ ì œê±°
                    //ì—¬ê¸°
                })
                .catch(error => {
                    alert("ì‚­ì œ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ!");
                    console.error("Error:", error);
                });
                //ì„¹ì…˜ 2 ì‹œê°„í‘œì—ì„œ ì‚­ì œ
                const lb = document.getElementById("lb" + lectureId);
                if(lb){
                    lb.remove()
                }
                else{
                    console.error("ì‹œê°„í‘œ ë¸”ë¡ ì‚­ì œ ì—ëŸ¬");
                }
            });
            li.appendChild(deleteButton);
            ul.appendChild(li);
        });
        tabContent.appendChild(ul);
    })
    .catch(error => console.error("íƒ­ ì‹œê°„í‘œ ì˜¤ë¥˜:", error));
}
    document.getElementById('titleSearchForm').addEventListener('submit', function(event){
        event.preventDefault(); // ê¸°ë³¸ í¼ ì œì¶œ ë°©ì§€

        const searchBox = document.getElementById('searchBox');

        fetch(`/search?title=${encodeURIComponent(searchBox.value)}`, {
            method: 'GET',
            headers: {
                'Cache-Control': 'no-store',
                'Accept': 'application/json',
                "Authorization": "Bearer " + localStorage.getItem("accessToken"),
            }
        })
        .then(response => response.json())
        //List<lectureDTO> ë„˜ì–´ì˜¬êº¼ê³ 
        .then(data => {
            renderSearchLectures(data);
        })
        .catch(error => {
            console.error('ê²€ìƒ‰ ì˜¤ë¥˜:', error);
        });
    });
    function renderSearchLectures(lectures) {
        const resultDiv = document.getElementById('tab1-1');
        resultDiv.innerHTML = '';

        if (lectures.length === 0) {
            resultDiv.innerHTML = '<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
        }

        const list = document.createElement('ul');
        list.classList.add("scrollable-list");

        lectures.forEach(lecture => {
            console.log("ê²€ìƒ‰ê²°ê³¼ ê°•ì˜ =", lectures);
            const listItem = document.createElement('li');
            let innerHtml = `
                <strong>${lecture.title}</strong>
                <br>
                êµìˆ˜: ${lecture.professor}<br>
                ì‹œê°„:
            `;
            lecture.lectureTimes.forEach(lectureTime => {
                innerHtml += `${lectureTime.dayOfWeek}ìš”ì¼ ${lectureTime.startTime} ~ ${lectureTime.endTime} `;
            });
            innerHtml += `<br>${lecture.grade}í•™ë…„  ${lecture.credit}í•™ì `;
            listItem.innerHTML = innerHtml.trim();

            const syllabusButton = document.createElement('button');
            syllabusButton.textContent = 'ê°•ì˜ê³„íšì„œ ë³´ê¸°';
            syllabusButton.addEventListener('click', function(){
                openSyllabus(lecture.id);
            });

            const applyButton = document.createElement('button');
            applyButton.textContent = 'ì‹œê°„í‘œì— ê°•ì˜ ì¶”ê°€';
            applyButton.style.marginLeft = '10px';
            applyButton.style.display = 'inline-block';
            applyButton.addEventListener('click', function(){
                applyLecture(lecture.id);
            });
            applyButton.addEventListener('mouseover', () => {
              showPreviewBlock(lecture);
            });

            applyButton.addEventListener('mouseout', () => {
              removePreviewBlock();
            });

            const addCartButton = document.createElement('button');
            addCartButton.textContent = 'ì¥ë°”êµ¬ë‹ˆì— ì €ì¥';
            addCartButton.style.marginLeft = '10px';
            addCartButton.style.display = 'inline-block';
            addCartButton.addEventListener('click', async () => {

              try {
                const response = await fetch(`/cart/lectures/${lecture.id}`, {
                  method: 'POST',
                  headers: {
                    'Authorization': 'Bearer ' + localStorage.getItem('accessToken')
                  },
                });
                if (!response.ok) {
                  const error = await response.text();
                  throw new Error(`ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€ ì‹¤íŒ¨: ${error}`);
                }
                //const result = await response.json();
                //console.log('ì¥ë°”êµ¬ë‹ˆì— ì €ì¥ ì„±ê³µ:', result);
                renderCart();
              } catch (err) {
                console.error(err);
                alert('ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
              }
            });


            list.appendChild(listItem);
            list.appendChild(syllabusButton);
            list.appendChild(addCartButton);
            list.appendChild(applyButton);
        });

        resultDiv.appendChild(list);
    }
    //ì‹œê°„í‘œì— ê°•ì˜ ì¶”ê°€
    function applyLecture(lectureId) {
        const activeTab = document.querySelector(".stab.active");
        const timetableName = activeTab.textContent.trim();
        fetch(`/timetables/lectures?id=${encodeURIComponent(lectureId)}&timetableName=${encodeURIComponent(timetableName)}`, {
            method: 'POST',
            headers: { 'Accept': 'application/json',
             "Authorization": "Bearer " + localStorage.getItem("accessToken")}
        })
        .then(response => response.json())
        .then(data => {
            //section1 tab2 ë‚´ìš© / section2 ì‹œê°„í‘œ ë‚´ìš© ë³€ê²½
            renderLectures(data);
            alert(`ê°•ì˜ ì‹ ì²­ ì„±ê³µ: ${data.message}`);

            getTimetableLectures(); // tab1-2 ì‹œê°„í‘œ ë¦¬ìŠ¤íŠ¸
        })
        .catch(error => {
            console.error('ê°•ì˜ ì‹ ì²­ ì˜¤ë¥˜:', error);
            alert('ê°•ì˜ ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒ.');
        });
    }
    const openBtn = document.getElementById("openTimePicker");
    const modal = document.getElementById("timePickerModal");
    const tbody = document.querySelector("#timeGrid tbody");
    let isDragging = false;
    let dragStart = null;
    let isErasing = false;
    let selectedTimeSlots = [];

    const days = ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ"];

    const radios = document.querySelectorAll('input[name="availability"]');
    radios.forEach(radio => {
        radio.addEventListener("change", () => {
            openBtn.disabled = (radio.value !== "custom");
        });
    });

    openBtn.addEventListener("click", () => {
        modal.style.display = "block";
        generateGrid();
    });

    function closeTimePicker() {
        modal.style.display = "none";
        document.getElementById("rangeList").innerHTML = "";
    }

    function generateGrid() {
        tbody.innerHTML = "";
        for (let h = 9; h <= 21; h++) {
            const row = document.createElement("tr");
            const timeCell = document.createElement("td");
            timeCell.textContent = `${h}:00`;
            row.appendChild(timeCell);

            days.forEach(day => {
                const cell = document.createElement("td");
                cell.dataset.day = day;
                cell.dataset.hour = h;

                if (selectedTimeSlots.some(slot => slot.day === day && slot.hour === h)) {
                    cell.classList.add("selected");
                }

                cell.addEventListener("mousedown", () => {
                    isDragging = true;
                    dragStart = cell;
                    isErasing = cell.classList.contains("selected");
                    updateDragSelection(cell);
                });

                cell.addEventListener("mouseover", () => {
                    if (isDragging && dragStart) {
                        updateDragSelection(cell);
                    }
                });

                cell.addEventListener("mouseup", () => {
                    isDragging = false;
                    dragStart = null;
                    updateRangeListFromGrid();
                });

                row.appendChild(cell);
            });
            tbody.appendChild(row);
        }
        document.addEventListener("mouseup", () => isDragging = false);
    }

    function updateDragSelection(current) {
        const startHour = parseInt(dragStart.dataset.hour);
        const endHour = parseInt(current.dataset.hour);
        const hourMin = Math.min(startHour, endHour);
        const hourMax = Math.max(startHour, endHour);

        const startDayIndex = days.indexOf(dragStart.dataset.day);
        const endDayIndex = days.indexOf(current.dataset.day);
        const dayMin = Math.min(startDayIndex, endDayIndex);
        const dayMax = Math.max(startDayIndex, endDayIndex);

        for (let h = hourMin; h <= hourMax; h++) {
            for (let d = dayMin; d <= dayMax; d++) {
                const cell = document.querySelector(`#timeGrid td[data-day='${days[d]}'][data-hour='${h}']`);
                if (cell) {
                    if (isErasing) {
                        cell.classList.remove("selected");
                    } else {
                        cell.classList.add("selected");
                    }
                }
            }
        }
    }

    function updateRangeListFromGrid() {
        const rangeList = document.getElementById("rangeList");
        rangeList.innerHTML = "";
        const selected = {};


        selectedTimeSlots = [];
        document.querySelectorAll("#timeGrid td.selected").forEach(cell => {
            selectedTimeSlots.push({
                day: cell.dataset.day,
                hour: parseInt(cell.dataset.hour)
            });
        });
        console.log("selectedTimeSlots=", selectedTimeSlots);

        document.querySelectorAll("#timeGrid td.selected").forEach(cell => {
            const day = cell.dataset.day;
            const hour = parseInt(cell.dataset.hour);
            if (!selected[day]) selected[day] = [];
            selected[day].push(hour);
        });

        Object.entries(selected).forEach(([day, hours]) => {
            hours.sort((a, b) => a - b);

            let start = null;
            for (let i = 0; i < hours.length; i++) {
                if (start === null) {
                    start = hours[i];
                }

                const next = hours[i + 1];
                if (next !== hours[i] + 1) {
                    const end = hours[i] + 1;
                    addRangeBlock(day, start, end);
                    start = null;
                }
            }
        });
    }

    function addRangeBlock(day, start, end) {
        const div = document.createElement("div");
        div.className = "range-block";
        div.innerHTML = `
            <span>${day} ${start}:00 ~ ${end}:00</span>
            <input type='hidden' name='days' value='${day}'>
            <input type='hidden' name='startTimes' value='${String(start).padStart(2, '0')}:00'>
            <input type='hidden' name='endTimes' value='${String(end).padStart(2, '0')}:00'>
        `;
        document.getElementById("rangeList").appendChild(div);
    }

    function applyBlocks() {
        const form = document.getElementById("searchForm");
        form.querySelectorAll("input[name='days'], input[name='startTimes'], input[name='endTimes']").forEach(e => e.remove());

        document.querySelectorAll("#rangeList input").forEach(input => {
            const clone = input.cloneNode(true);
            form.appendChild(clone);
        });
        closeTimePicker();
    }
    document.getElementById("addTimetableForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = e.target.name.value;

      const res = await fetch("/timetables", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer " + localStorage.getItem("accessToken"),
        },
        body: JSON.stringify({ name }),
      });

      if (res.ok) {
        alert("ì‹œê°„í‘œ ì¶”ê°€ ì„±ê³µ!");
        fetchTimetables(); // ìƒˆë¡œê³ ì¹¨ ë˜ëŠ” UI ê°±ì‹ 
      } else {
        alert("ì‹œê°„í‘œ ì¶”ê°€ ì‹¤íŒ¨!");
      }
    });
    const checkbox = document.getElementById("timeSearchCheckbox");
    const emptyRadio = document.getElementById("emptyTime");
    const customRadio = document.getElementById("customTime");
    const timeButton = document.getElementById("openTimePicker");

    checkbox.addEventListener("change", function () {
        const enabled = this.checked;

        // ì²´í¬ë°•ìŠ¤ê°€ ì²´í¬ë˜ë©´ ë¼ë””ì˜¤ ë²„íŠ¼ í™œì„±í™”, ì•„ë‹ˆë©´ ì „ë¶€ ë¹„í™œì„±í™”
        emptyRadio.disabled = !enabled;
        customRadio.disabled = !enabled;
        timeButton.disabled = true; // ë¬´ì¡°ê±´ ë²„íŠ¼ì€ ì´ˆê¸° ìƒíƒœì—ì„  ë¹„í™œì„±í™”

        // ë¼ë””ì˜¤ ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”ë„ í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ë¼ì¸ë„ ì¶”ê°€
        if (!enabled) {
            emptyRadio.checked = false;
            customRadio.checked = false;
        }
    });

    // ë¼ë””ì˜¤ ì¤‘ "ì‹œê°„ëŒ€ ì§ì ‘ ì„ íƒ"ì´ ëˆŒë¦¬ë©´ ë²„íŠ¼ í™œì„±í™”
    customRadio.addEventListener("change", function () {
        if (this.checked && !this.disabled) {
            timeButton.disabled = false;
        }
    });

    // "ë¹ˆ ì‹œê°„ëŒ€ ê²€ìƒ‰" ì„ íƒ ì‹œ ë²„íŠ¼ì€ ë¹„í™œì„±í™” ìœ ì§€
    emptyRadio.addEventListener("change", function () {
        if (this.checked && !this.disabled) {
            timeButton.disabled = true;
        }
    });
    function openSyllabus(lectureId) {
      const token = localStorage.getItem('accessToken');
      fetch(`/lectures/${lectureId}/syllabus`, {
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('accessToken'),
            'Cache-Control': 'no-store',
         }
      })
      .then(res => {
        if (!res.ok) throw new Error('ì¸ì¦ ì‹¤íŒ¨');
        return res.text();
      })
      .then(html => {
        const w = window.open('', '_blank');
        w.document.write(html);
        w.document.close();
      })
      .catch(err => {
        alert('ê°•ì˜ê³„íšì„œë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤: ' + err.message);
      });
    }

    let memberProfile  = null;

    function fetchUserProfile() {
      return fetch('/members/me', {
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('accessToken') ,'Cache-Control': 'no-store',}
      })
      .then(res => {
        if (!res.ok) throw new Error('í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨');
        return res.json();
      })
      .then(profile => {
        memberProfile = profile;
        renderProfile();
      });
    }
    function renderProfile() {
      const memberInfoDiv = document.getElementById('memberInfo');
      memberInfoDiv.textContent = `${memberProfile.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;
    }
    document.getElementById('searchBox').addEventListener('keyup', function() {
      const query = this.value;
      if (query.length === 0) {
        document.getElementById('suggestions').innerHTML = '';
        return;
      }

      fetch(`/lectures?keyword=${query}`,{
            method: 'GET',
            headers: {
              "Content-Type": "application/json",
              "Authorization": "Bearer " + localStorage.getItem("accessToken"),
              'Cache-Control': 'no-store',
            }})
        .then(response => response.json())
        .then(lectures => {
          const suggestionList = document.getElementById('suggestions');
          suggestionList.innerHTML = '';
          lectures.forEach(lecture => {
            const li = document.createElement('li');
            li.textContent = lecture.title;
            li.style.padding = '5px';
            li.style.cursor = 'pointer';
            li.addEventListener('click', () => {
              searchBox.value = lecture.title;  // ì„ íƒí•˜ë©´ ì…ë ¥ì°½ì— ë“¤ì–´ê°
              suggestionList.style.display = 'none';  // ëª©ë¡ ìˆ¨ê¸°ê¸°
            });
            suggestionList.appendChild(li);
          });
          suggestionList.style.display = 'block';

        });

    });
    function showPreviewBlock(lecture) {
      const days = { "ì›”": 1, "í™”": 2, "ìˆ˜": 3, "ëª©": 4, "ê¸ˆ": 5 };
      const startHour = 9;

      const activeTab = document.querySelector('.stab-content.active');
      if (!activeTab) return;

      const container = activeTab.querySelector(".lecture-container");
      const table = activeTab.querySelector(".timetable");
      const headerCells = table.querySelectorAll("thead th");
      const tbody = table.querySelector("tbody");

      const theadHeight = table.querySelector("thead").offsetHeight;
      const columnWidth = headerCells[1].offsetWidth;
      const totalHours = tbody.querySelectorAll("tr").length;
      const hourHeight = tbody.offsetHeight / totalHours;

      lecture.lectureTimes.forEach(lt => {
        const dayIndex = days[lt.dayOfWeek];
        if (dayIndex === undefined) return;

        const { hour: startHourVal, minute: startMinuteVal } = parseTime(lt.startTime);
        const { hour: endHourVal, minute: endMinuteVal } = parseTime(lt.endTime);

        const startOffset = theadHeight + ((startHourVal - startHour) * hourHeight) + (startMinuteVal / 60 * hourHeight);
        const duration = (endHourVal * 60 + endMinuteVal) - (startHourVal * 60 + startMinuteVal);
        const blockHeight = (duration / 60) * hourHeight;
        const timeColumnWidth = headerCells[0].offsetWidth;

        const previewBlock = document.createElement("div");
        previewBlock.classList.add("lecture-block");
        previewBlock.classList.add("preview-block");
        previewBlock.style.top = `${startOffset}px`;
        previewBlock.style.height = `${blockHeight}px`;
        previewBlock.style.left = `${timeColumnWidth + (dayIndex - 1) * columnWidth}px`;
        previewBlock.style.width = `${columnWidth - 10}px`;
        previewBlock.style.backgroundColor = "#4aa8d8"; // íë¦¬ê²Œ
        previewBlock.style.opacity = "0.6";             // ë°˜íˆ¬ëª…
        previewBlock.textContent = lecture.title;

        container.appendChild(previewBlock);
      });
    }
    function removePreviewBlock() {
      const previews = document.querySelectorAll('.preview-block');
      previews.forEach(p => p.remove());
    }

    async function logout() {
      try {
        await fetch('/logout', {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer ' + localStorage.getItem('accessToken')
          }
        });
      } catch (err) {
        console.warn('ì„œë²„ ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜:', err);
      } finally {

        localStorage.removeItem('accessToken');
        window.location.href = '/login';
      }
    }
    // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì— ì—°ê²°
    document.getElementById('logoutButton')
            .addEventListener('click', logout);

    function renderCart() {
        const resultDiv = document.getElementById('tab1-3');
        resultDiv.innerHTML = '';

        fetch('/cart/lectures', {
            method: "GET",
            headers: {
                "Authorization": "Bearer " + localStorage.getItem("accessToken"),
                'Cache-Control': 'no-store',
            }
        })
        .then(response => response.json())
        .then(lectures => {
            console.log("ë°›ì€ lectures:", lectures);
            if (!lectures || lectures.length === 0) {
                resultDiv.innerHTML = '<p>ì¥ë°”êµ¬ë‹ˆ ì—†ìŒ</p>';
                return;
            }

            const list = document.createElement('ul');
            list.classList.add("scrollable-list");

            lectures.forEach(lecture => {
                const listItem = document.createElement('li');
                let innerHtml = `
                    <strong>${lecture.title}</strong>
                    <br>
                    êµìˆ˜: ${lecture.professor}<br>
                    ì‹œê°„:
                `;
                lecture.lectureTimes.forEach(lectureTime => {
                    innerHtml += `${lectureTime.dayOfWeek}ìš”ì¼ ${lectureTime.startTime} ~ ${lectureTime.endTime} `;
                });
                innerHtml += `<br>${lecture.grade}í•™ë…„  ${lecture.credit}í•™ì `;
                listItem.innerHTML = innerHtml.trim();

                const syllabusButton = document.createElement('button');
                syllabusButton.textContent = 'ê°•ì˜ê³„íšì„œ ë³´ê¸°';
                syllabusButton.addEventListener('click', function(){
                    openSyllabus(lecture.id);
                });

                const applyButton = document.createElement('button');
                applyButton.textContent = 'ì‹œê°„í‘œì— ê°•ì˜ ì¶”ê°€';
                applyButton.style.marginLeft = '10px';
                applyButton.addEventListener('click', function(){
                    applyLecture(lecture.id);
                });
                applyButton.addEventListener('mouseover', () => showPreviewBlock(lecture));
                applyButton.addEventListener('mouseout', () => removePreviewBlock());

                const addCartButton = document.createElement('button');
                addCartButton.textContent = 'ì¥ë°”êµ¬ë‹ˆì—ì„œ ì‚­ì œ';
                addCartButton.style.marginLeft = '10px';
                addCartButton.addEventListener('click', async () => {
                    try {
                        const response = await fetch(`/cart/lectures/${lecture.id}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': 'Bearer ' + localStorage.getItem('accessToken')
                            },
                        });
                        if (!response.ok) throw new Error(await response.text());
                        renderCart();
                    } catch (err) {
                        console.error(err);
                    }
                });

                list.appendChild(listItem);
                list.appendChild(syllabusButton);
                list.appendChild(addCartButton);
                list.appendChild(applyButton);
            });

            resultDiv.appendChild(list);
        })
        .catch(error => console.error("renderCart ì˜¤ë¥˜:", error));
    }


</script>

</body>
</html>